<!DOCTYPE html>
<html>

<head>
  <title>Contract Management</title>


  <!-- Bootstrap core CSS -->
  <link href="/mdbootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="/mdbootstrap/css/mdb.min.css" rel="stylesheet">
  <link href="/mdbootstrap/css/style.css" rel="stylesheet">


  <!-- material design.io -->
  <link href="/material-components-web/dist/material-components-web.min.css" rel="stylesheet">
  <script src="/material-components-web/dist/material-components-web.min.js"></script>
  <link href="/font-awesome/css/font-awesome.min.css">

  <link rel='stylesheet' href='/stylesheets/style.css' />
</head>

<body>
  <template id="temp_contract">
    <!-- Column -->
    <div class="col-md-4 mb-4 d-flex align-items-stretch">

      <!--Card-->
      <div class="card">

        <!--Card image-->
        <div class="view">
          <img src="https://mdbootstrap.com/img/Photos/Horizontal/Nature/6-col/img%20(133).jpg" class="card-img-top"
            alt="">
          <a href="#">
            <div class="mask rgba-white-slight"></div>
          </a>
        </div>

        <!--Card content-->
        <div class="card-body">
          <!--Title-->
          <h4 class="card-title">Card title</h4>
          <!--Text-->
          <p class="card-text">Some quick example text to build on the card title and make up the bulk of the
            card's content.</p>
        </div>

      </div>
      <!--/.Card-->

  </template>
  <template id="contract_detail">
    <%- include('templateDetails.ejs') %> 
  </template>

  <main>
    <header>
      <h2>
        <b>Quản lý và Tạo hợp đồng</b>
      </h2>
    </header>
    <submain>
      <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item">
          <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home"
            aria-selected="true">Tạo hợp đồng</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile"
            aria-selected="false">Quản lý hợp đồng</a>
        </li>
      </ul>
      <div class="tab-content" id="myTabContent">
        <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
          <template-handler class="row">

          </template-handler>
          <button type="button" class="btn btn-primary" id="addTemplate">Add Contract Template</button>
        </div>
        <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
          <contract-handler>
            <%- include('contractDetails.ejs')%>
          </contract-handler>
        </div>
      </div>
    </submain>
  </main>
  <div class="container-fluid">
    <!-- Modal -->

    <!-- Central Modal Small -->
    <div class="modal fade" id="centralModalSm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
      aria-hidden="true">

      <!-- Change class .modal-sm to change the size of the modal -->
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title w-100" id="myModalLabel">Modal title</h4>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <modal-body>
              <!-- Adding dynamic content here -->
              <h2>I am going to add a dynamic content here</h2>
            </modal-body>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary btn-sm">Create new Contract</button>
          </div>
        </div>
      </div>
    </div>
    <!-- Central Modal Small -->
  </div>
  
  <link href="/mdbootstrap/js/popper.min.js">
  <!-- libs scripts -->
  <script src="/mdbootstrap/js/jquery.min.js"></script>
  <script src="/mdbootstrap/js/popper.min.js"></script>
  <script src="/mdbootstrap/js/bootstrap.min.js"></script>
  <script src="/mdbootstrap/js/mdb.min.js"></script>
  <script>
    templateContent = document.getElementById('temp_contract').content;
    card_handler = document.querySelector('template-handler')

    for (var i = 1; i < 9; i++) {

      clone = document.importNode(templateContent, true);
      // clone.setAttribute('id',i)
      card_handler.appendChild(clone)
      item = card_handler.lastChild;
      item.setAttribute('id', i)
      console.log("item", item)
      item.addEventListener('click', function (evt) {
        console.log('Iam here', this)
        $("#centralModalSm").modal();
        modalBody = document.querySelector('modal-body')
        while (modalBody.firstChild) {
          modalBody.removeChild(modalBody.lastChild)
        }
        modalBody.appendChild(this.cloneNode(true))
        console.log('modalBody', modalBody)
      })
    }

    console.log("template", templateContent)
    console.log('card_handler', card_handler)

    // $("#centralModalSm").on('hide.bs.modal', function () {
    //   alert('The modal is about to be hidden.');
    // });

    addTemplateBnt = document.getElementById('addTemplate').addEventListener('click', (evt) => {
      // Adding something here before popup
      modalBody = document.querySelector('modal-body')
      while (modalBody.firstChild) {
        modalBody.removeChild(modalBody.lastChild)
      }
      tmpContent = document.getElementById('contract_detail').content;
      clone = document.importNode(tmpContent, true);
      modalBody.appendChild(clone)

      $("#centralModalSm").modal();
    })

  </script>
</body>

</html>